"use strict";function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,n){if(e){if("string"==typeof e)return _arrayLikeToArray(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(e,n):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function _construct(e,n,t){return(_construct=_isNativeReflectConstruct()?Reflect.construct:function(e,n,t){var r=[null];r.push.apply(r,n);var a=new(Function.bind.apply(e,r));return t&&_setPrototypeOf(a,t.prototype),a}).apply(null,arguments)}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function _setPrototypeOf(e,n){return(_setPrototypeOf=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e})(e,n)}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e,n){var t="Sequence";"function"==typeof define&&define.amd?define([],n(t)):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=n(t):e[t]=n(t)}(window||module||{},function(r){var d={},o={loadBalance:10,preloadStep:0};function a(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];this?(d.this=this,d.name=r,d.target=".sequence","string"==typeof n[0]&&(d.target=n[0]),"object"===_typeof(n[0])&&n[0].nodeName&&(d.targetEl=n[0]),"object"!==_typeof(n[n.length-1])||n[n.length-1].nodeName||Object.assign(d,n[n.length-1]),d.this.initialize()):_construct(a,n)}var n=function(e,n){var t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};if(!e||!n)return!1;(e=Array.isArray(e)?e:[e]).forEach(function(e){t?e.dispatchEvent(new CustomEvent(n,{detail:t})):e.dispatchEvent(new Event(n))})},t=function(n,t){var r=null;return function(e){r&&window.cancelAnimationFrame(r),r=window.requestAnimationFrame(function(){n(e,t)})}},c=function(e){if(e===d.currentIndex)return!1;e=e<0?0:e>=d.length?d.length-1:e,d.currentIndex=e,d.canvas.dataset.index=d.currentIndex,d.canvas.dataset.readyState<2&&(d.canvas.dataset.readyState=2),i(d.currentIndex),d.watch&&d.watch.includes(d.currentIndex)&&(d.watching=!0,n(d.targetEl,"sequenceWatch",{currentIndex:d.currentIndex,lenth:d.length,reverse:d.prevIndex>d.currentIndex}),d.watching=!1),d.prevIndex=d.currentIndex},s=function(e){d.loaded++,d.loaded>=d.loadBalance*(o.preloadStep+1)&&(d.canvas.dataset.readyState=1,d.this.ready=!0,d.preload&&(o.preloadStep++,i())),d.loaded===d.length&&(d.canvas.dataset.readyState=3,t(c(d.currentIndex)),n(d.targetEl,"sequenceLoaded",{length:d.length}))},i=function(n){var e,a=!0;if(n||0===n){var t=d.imageArray.filter(function(e){return!e.loaded}),r=n-d.loadBalance,o=n+d.loadBalance,c=t.filter(function(e){return e.index<n&&e.index>=r}).length,i=t.filter(function(e){return e.index>n&&e.index<=o}).length,l=i<d.loadBalance?r-(d.loadBalance-i):r-(o>=d.length-1?o-(d.length-1):0),u=c<d.loadBalance?o+(d.loadBalance-c):o+(r<=0?Math.abs(r):0);e=d.imageArray.filter(function(e){return e.index<=u&&e.index>=l&&!e.loaded}),a=!1}else e=d.imageArray.filter(function(e){return!e.loaded});e.forEach(function(e,n){if(a&&n>=d.loadBalance)return!1;var t=0!==d.currentIndex&&d.canvas.querySelector("img.index--".concat(e.index-1)),r=new Image;r.src=e.src,r.className="index--".concat(e.index),r.addEventListener("load",s),e.loaded=!0,t?t.after(r):d.canvas.append(r)})};return a.prototype={initialize:function(){if(d.start>d.end)return!1;var a=document.createElement("style");a.textContent="\n        .sequence-holder {\n          font-size: 0;\n        }\n        .sequence-holder img {\n          position: absolute;\n          top: 0;\n          right: 0;\n          left: 0;\n          opacity: 0;\n        }\n        .sequence-holder img.size-safer {\n          position: relative;\n        }\n        .sequence-holder:not([data-index]) img.index--0 {\n          opacity: 1;\n        }\n      "+(d.customStyle||""),d.targetEl=d.targetEl||document.querySelector(d.target),d.imgSrc=d.dir+d.prefix+(d.pad?_toConsumableArray(new Array(d.pad)).map(function(e){return 0}).join(""):"")+"."+d.type,d.imageArray=_toConsumableArray(new Array(d.end-d.start)).map(function(e,n){var t=n+(d.start||0),r=new RegExp("0{".concat((t+"").length,"}(.").concat(d.type,")"));return a.textContent+='\n          .sequence-holder[data-index="'.concat(n,'"] img.index--').concat(n,' {\n            opacity: 1;\n            z-index: 20;\n          }\n          .sequence-holder[data-index="').concat(n,'"] img.index--').concat(n-1,',\n          .sequence-holder[data-index="').concat(n,'"] img.index--').concat(n+1," {\n            opacity: 1;\n            z-index: 10;\n          }\n        "),{index:n,src:d.imgSrc.replace(r,"".concat(t,"$1"))}});var e,n=document.createElement("div"),t=d.targetEl.attachShadow({mode:"open"});n.className="sequence-holder",n.dataset.readyState="0",t.append(a),t.append(n),d.canvas=t.querySelector(".sequence-holder"),d.length=d.imageArray.length,d.prevIndex=0,d.currentIndex=0,d.loaded=0,d.watch=d.watch&&(Array.isArray(d.watch)?d.watch:[d.watch]),d.loadBalance=(-1===d.loadBalance?d.length:d.loadBalance)||d.fps||o.loadBalance,(e=new Image).src=d.imageArray[0].src,e.className="size-safer",d.canvas.append(e),i(d.currentIndex)},play:function(e){d.reverse=e&&e.reverse,d.currentIndex=e&&(e.startAt||0===e.startAt)?e.startAt:d.currentIndex,clearInterval(d.runner),d.runner=setInterval(function(){t(c(d.currentIndex)),d.currentIndex+=d.reverse?-1:1,(d.reverse?d.currentIndex<0:d.currentIndex>d.imageArray.length-1)&&(d.loop?d.currentIndex=d.reverse?d.length-1:0:(clearInterval(d.runner),n(d.targetEl,"sequenceDone",{currentIndex:d.currentIndex-(d.reverse?-1:1),lenth:d.length,reverse:d.reverse})))},1e3/(d.fps||24))},stop:function(){clearInterval(d.runner),n(d.targetEl,"sequenceStop",{currentIndex:d.currentIndex-(d.watching?0:d.prevIndex>d.currentIndex?-1:1),lenth:d.length,reverse:d.prevIndex>d.currentIndex})},go:function(e){t(c(e))}},a});